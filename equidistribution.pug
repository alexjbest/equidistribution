section#sec-equidistribution-intro
    title Equidistribution in Number Theory

    introduction
        aside: p Lecture 1 6/9/2018
        p.
            These are notes for Ali Altuğ's course MA841 at BU Fall 2018.

        p.
            The course webpage is #[url(href="http://math.bu.edu/people/saaltug/2018_3/2018_3_sem.html")/].
        p.
            Course overview:

            Upon Akshay Venkatesh winning the fields medal I decided to dedicate this term to various aspects of equidistribution results in number theory and their relations to L-functions. I am aiming to cover basic results like Linnik's and Duke's theorems, as well as certain aspects of subconvexity. As we move along we may briefly touch several other aspects like quantum unique ergodicity (QUE) or equidistribution in other settings (e.g. over function fields).

            There is an abundance of material on this topic. We will not follow a single book or an article (although the first book and the survey articles following that will be the main reference), however here are a bunch of helpful papers/books. I will update these references as we move along.

    subsection#subsec-equidistribution-introduction
        title Introduction

        blockquote
            p I wasn't going to do this at all, but then Akshay won the Fields medal.
            attribution
                line Ali Altuğ

        p
            | Some topics we will try and cover:
            ol
                li
                    | Linnik's and Duke's theorem 1970-1990
                li
                    | lattice points and hyperbolic geometry
                li
                    | modular forms
                li
                    | spectral theory
                li
                    | modular forms of half integral weight.
                li
                    | harmonic analysis
                li
                    | Kuznetsov formula
                li
                    | Other topics!

    subsection#subsec-linnik-duke
        title Linnik and Duke

        p
            | Akshay's first breakthrough, according to Sarnak, was subconvexity.
            | He became interested in ergodic theory, because they could prove hard theorems, equidistribution is a powerful tool in number theory.

        p
            | Our main goal will be to talk about: Some problems stated (and proved) by Linnik.
            | In the book, Ergodic properties of algebraic fields, 1968.
            | He considered lattice points on a sphere of radius #[m n], these are points (say in #[m \RR^3]) whose coordinates are integral of a fixed distance from the origin.
            | Analogous to the circle problem.
            | If #[m n] is fixed there is nothing to distribute, but if we vary #[m n] and project down we can ask do they accumulate miss any patches, generally how do they distribute.

            | Of course this can be generalised.

        paragraphs
            title Setup

            p
                | Sphere #[m S^2].
            p
                | Lattice points #[m \alpha = (x_1, x_2, x_3) \in \ZZ^3].
            p
                me |\alpha|^2 =  x_1^2 + x_2^2 + x_3^2
                | this is where the number theory comes, we are looking at representability of numbers #[m n] by this ternary quadratic form.
            p
                | Various methods exist for studying this for varying #[m n], quadratic reciprocity for #[m n=2], circle method/Vinogradov for #[m n=4].
                | #[m n=3] is the cut off, here half integral weight modular forms are relevant.

            p
                | Set
                me \Omega_N = \left\{x= \frac{\alpha}{|\alpha|} : \alpha \in \ZZ^2 ,\,|\alpha|^2 = N \right\}\subseteq S^2
                | .

        question
            statement: p
                | Are #[m \Omega_N] #[q equidistributed]  as #[m N \to \infty]?

        p
            | There is an immediate obstruction to #[m N] being a sum of #[m 3] squares, e.g. #[m N = 7] implies #[m \Omega_7 = \emptyset].
        p
            | Recall: (Gauss/Legendre)
            me N = x_1^2 + x_2^2+ x_3^2,\,x_i \in \ZZ \iff N \ne 4^a(8b+7)
            | , so we avoid these sets and ask the same question.

        theorem#thm-linnik
            title Linnik
            statement: p
                | Let #[m f \in \cinf(S^2)], then as #[m N \to \infty], #[m N] squarefree #[m N \not\equiv 7 \pmod 8], #[m \legendre{N}{p} = 1] for some fixed odd prime #[m p]
                me \frac{1}{\# \Omega_N} \sum_{x\in \Omega_N} f(x) \to \int_{S^2} f\diff \sigma
                | where #[m \diff \sigma] is the Lebesgue measure on #[m S^2].

        p
            | This is saying that the points are equidistributed with respect to the Lebesgue measure.

        p
            | The last condition is a defect of the method, known as a Linnik condition.

        remark: p
            | Linnik's proof is ergodic theoretic.
        p
            | After this came Duke in 1988, in the mean time, Weil conjectures were proved, Iwaniec gave bounds for Kloosterman sums.
            | Duke was a graduate student of Sarnak at Courant.

            | He gave a more direct proof of #[xref(ref="thm-linnik")/] which does not have the #[m \legendre{N}{p} = 1] condition.
            | His proof is based on the theory of (half integral weight) modular forms, and a good bound Iwaniec on certain exponential sums.

        p
            | Why do exponential sums enter the picture?
            | We are trying to prove that we have a sum converging to an integral.
            | Generally we work with a basis of functions first, we could try using fourier analysis, using harmonics as our basis, this is when exponential sums appear.
            | That requires us to work out harmonics on the sphere (spherical harmonics) which leads to representation theory, which as the sphere is compact involves Weyl representations etc.
        p
            | Duke also proved #[q the same] theorem over  modular surfaces.
            | Instead of looking at expanding spheres we study expanding hyperboloids.


        paragraphs
            title Setup

            p
                | Space
                me \pm \Gamma\backslash \HH
                me \HH = \left\{ x+iy \in CC : y \gt 0\right\}
                me \Gamma = \SL_2(\ZZ)
                me \mathcal F = \left\{ z\in \HH : -\frac12 \le \Re(z) \le 0, |z| \ge 1 \text{ or }\frac12 \gt \Re(z) \gt 0, |z| \gt 1 \right\}
            figure
                caption #[m \mathcal F]
                image: latex-image.
                    <![CDATA[
                    \begin{tikzpicture}
                        \draw[thick] (-7,0) -- (7,0);
                        \filldraw[fill=gray!20!white, draw=gray!20!white] (1.5,7) -- (1.5,2.598076211) arc (60:120:3cm) -- (-1.5,7) -- (1.5,7);
                        \draw[thick,dotted] (4.5,0) -- (4.5,7);
                        \draw[thick,dotted] (-4.5,0) -- (-4.5,7);
                        \draw[thick,dotted] (6,0) arc (0:180:3cm);
                        \draw[thick,dash dot] (1.5, 2.598076211) -- (1.5,7);
                        \draw[thick,dotted] (1.5, 2.598076211) -- (1.5,0);
                        \draw[thick] (-1.5, 2.598076211) -- (-1.5,7);
                        \draw[thick,dotted] (-1.5, 2.598076211) -- (-1.5,0);
                        \draw[thick,dash dot] (1.5, 2.598076211) arc(60:90:3cm);
                        \draw[thick] (0, 3) arc(90:120:3cm);
                        \draw[thick,dotted] (3,0) arc (0:60:3cm);
                        \draw[thick,dotted] (-1.5, 2.598076211) arc (120:180:3cm);
                        \draw[thick,dotted] (6,0) arc (0:180:3cm);
                        \draw[thick,dotted] (0,0) arc (0:180:3cm);
                        \draw[thick,dotted] (3,0) arc (180:90:3cm);
                        \draw[thick,dotted] (-3,0) arc (0:90:3cm);
                        \draw[thick,dotted] (0,0) arc (0:180:1cm);
                        \draw[thick,dotted] (-3,0) arc (180:0:1cm);
                        \draw[thick,dotted] (-3,0) arc (0:180:1cm);
                        \draw[thick,dotted] (-6,0) arc (180:0:1cm);
                        \draw[thick,dotted] (0,0) arc (180:0:1cm);
                        \draw[thick,dotted] (3,0) arc (0:180:1cm);
                        \draw[thick,dotted] (3,0) arc (180:0:1cm);
                        \draw[thick,dotted] (6,0) arc (0:180:1cm);
                        %\node at (0, 5){$D_w\f M\g$};
                        \node at (0,-.35){$0$};
                        \node at (1.5,-.35){$\frac{1}{2}$};
                        \node at (3,-.35){$1$};
                        \node[inner sep=1.5pt, circle, fill=black]  (p) at (0,3) {};
                        \node at (.15,3.2){$i$};
                        \node[inner sep=1.5pt, circle, fill=black]  (p) at (0,6) {};
                        \node at (.7,6.2){$w=ki$};
                        \node[inner sep=1.5pt, circle, fill=black]  (p) at (1.5,2.598076211) {};
                        %\node at (1.75,2.2){$v_2$};
                        \node at (1.3, 3){$\frac{\pi}{3}$};
                        \node[inner sep=1.5pt, circle, fill=black]  (p) at (-1.5,2.598076211) {};
                        %\node at (-1.25,2.2){$v_1$};
                        \node at (-1.3, 3){$\frac{\pi}{3}$};
                    \end{tikzpicture}
                    ]]>

            p
                | #[m \Omega_N]'s are now replaced with CM points.

        paragraphs
            title Digression (CM points)

            p
                | #[m Q] a binary quadratic form
                me Q(x,y) = ax^2+ bxy + cy^2
                | of discriminant #[m d = b^2-  4ac \lt 0], #[m a,b,c\in \ZZ].
                // TODO do we need a gt 0 here?!

            theorem
                title Gauss
                statement: p
                    | There are only finitely many equivalence classes of such forms for fixed  #[m d].

            p
                | The number of such is given by the Hurwitz class number.
            p
                | Given #[m Q] we associate a CM point
                me z_Q = \frac{-b + \sqrt{d}}{2a} \in \HH
                | .

            p
                | The action of #[m \Gamma] on #[m Q] is the same as the action of #[m \Gamma] on #[m z_Q].
                me z_{\gamma Q }  =\gamma z_Q
                |.

            p
                | Let
                me \Lambda_d  = \{z_Q \in \mathcal F : \disc(Q) = d\}
                | .

            p
                | We need to sum properly to take automorphisms into account.

            definition
                statement: p
                    me \sum{\vphantom{\sum}}^*_{z_Q \in \Lambda_d}
                    | is the sum weighted by #[m \frac 12] if #[m Q = a(x^2+ y^2)] (#[m d= -4]), #[m \frac 13] if #[m Q = a(x^2+ xy+y^2)] (#[m d= -3]).

            p
                | If we want to be fancy we can say the word stack here.

            remark
                p
                    me \sum_{z_Q \in \Lambda_d}{\vphantom{\sum}}^*1 = H(d)
                    | where #[m H(d)] is the Hurwitz class number.


            remark
                p
                    | If #[m d] is fundamental, i.e. a discriminant of some #[m \QQ(\sqrt{d})] then #[m H(d) = h(d)] the regular class number.

        p
            | For the measure on #[m \mathcal F] we take
            me \diff\mu = \frac 3\pi \frac{\diff x \diff y}{y^2}
            |.

        theorem#thm-duke
            title Duke
            statement: p
                | Let #[m f \in \cinf(\HH)], that is #[m \Gamma] invariant and bounded on #[m \mathcal F],  then as #[m d \to \infty] over fundamental discriminants
                me \frac{1}{\# \Lambda_d} \sum_{z\in \Lambda_d}{\vphantom{\sum}}^* f(z) \to \iint_{\mathcal F} f\diff \mu
                | .

        p
            | Equidistribution implies density, but is so much more, for example we cannot have dense points but which happen to cluster towards some line for example.

    subsection#subsec-equidist-basics
        title Basics

        aside: p Lecture 2 11/9/2018

        p
            | Question: Let #[m \alpha \in \RR] and consider #[m \{ \alpha n \}] where #[m \{ x \} = x \pmod 1] so #[m \left\{\frac32\right\} = \frac 12].
            | How are these distributed?

        example
            statement: p
                | If #[m \alpha = \frac 27] then we have #[m \{ \{\alpha n \} : n \in \NN\}  = \{\frac i7 : i \in \{0,\ldots, 6\}\}] and in fact it hits each evenly.


        example
            statement: p
                | If #[m \alpha = \sqrt 2] so #[m \{\alpha\}  \approx 0.4142?...] #[m \{\alpha2\}  \approx 0.8284?...] #[m \{\alpha3\}  \approx 0.24264...] #[m \{\alpha4\}  \approx 0.656854..].
                | These spread out densely, but there is a difference between density and equidistribution.
                | In this example, equidistribution says that the proportion of time the sequence spends in each interval #[m (a,b)] is #[m b -a].

        p
            | So questions are: is #[m \{n\alpha\}] dense?
        p
            | Is #[m \{n \alpha\}] uniformly distributed (equidistributed with respect to the standard measure)?
        p
            | The answer to both questions is yes.

        theorem
            title Kronecker
            statement: p
                | Let #[m \alpha \in \RR\smallsetminus \QQ] then #[m \{n \alpha\}] is dense in #[m \lb 0,1)].

        paragraphs
            title Digression (Diophantine approximation)

            p
                | This is a very tough area of number theory, not so many definitive results here.

            theorem
                title Dirichlet
                statement: p
                    | Let #[m \alpha \in \RR,N\in \ZZ_{\gt 0}] then there exists #[m p,q] with #[m q \gt 0].
                    me \left| q\alpha - p \right| \lt \frac 1N
                    | .
                proof: p
                    | (Pidgeonhole) divide #[m \lb 0, 1)] into even #[m N] subintervals of width #[m \frac 1N], consider
                    me \alpha_0 = 0,\alpha_1 = \left\{ \alpha 1\right\}, \alpha_2 = \left\{ \alpha 2\right\}, \ldots\in \lb 0,1)
                    | as soon as we get to #[m \alpha_N] we must have two in one subinterval say #[m |\alpha_{n_1} - \alpha_{n_2}| \lt \frac 1N].
                    | So there exists #[m p_{n_1}, p_{n_2}] such that
                    me | n_1 \alpha - k_{n_1} - (n_2\alpha - k_{n_2}) | \lt \frac1N
                    me | (n_1  - n_2)\alpha -( k_{n_1} - k_{n_2}) | \lt \frac1N
                    | .

            corollary
                statement: p
                    | Let #[m \alpha \in \RR\smallsetminus \QQ] then there exists infinitely many coprime #[m p,q] with #[m q \gt 0] satisfying
                    me \left| \alpha - \frac pq \right| \lt \frac {1}{q^2}
                    | .
                proof: p Exercise.

            p
                | This is very strong, Roth's theorem tells us that even #[m q^{2+\epsilon}] here is enough to force finiteness.

            note: p
                | #[m \alpha \not \in \QQ] is necessary! Otherwise
                me \left | \frac{p_0}{q_0} - \frac pq \right| = \left | \frac{p_0q - pq_0}{qq_0} \right| \ge \frac{\left | p_0q - pq_0 \right|}{\max \left\{q^2 ,q_0^2 \right\}}
                | so choose #[m q \gt q_0] implies #[m \frac {p_0}{q_0} = \frac pq].

            p
                | One can do better:

            theorem
                title Hurwitz
                statement: p
                    | Let #[m \alpha \in \RR\smallsetminus \QQ]
                    me \left| \alpha - \frac pq \right| \lt \frac {1}{\sqrt 5q^2}
                    | then there exists infinitely many coprime #[m p,q] with #[m q \gt 0] satisfying.

            note: p
                | #[m \sqrt 5] is the best possible without further restriction on #[m \alpha].

            example: statement: p
                | If #[m \alpha = \frac{1- \sqrt 5}{2}] then
                me \left| \alpha - \frac pq \right| \lt \frac {1}{Aq^2}
                | has only finitely many solutions for #[m A \gt \sqrt 5].

            p
                | What if we allow further restriction?

            theorem
                title Liouville
                statement: p
                    | Let #[m \alpha \in \RR] algebraic of degree #[m n \gt 1].
                    | Then there exists #[m A \gt 0] such that for all #[m p,q] with #[m g \gt 0]
                    me \left| \alpha - \frac pq \right| \gt \frac {A}{q^n}
                    | .
                proof: p
                    | Let #[m f \in \ZZ\lb x \rb] be the minimal polynomial of #[m \alpha].
                    | Gauss's lemma implies that #[m f] is irreducible over #[m \QQ] so
                    me q^n f\left(\frac pq\right)  \in \ZZ \smallsetminus\{0\}\,\forall \frac pq\in \QQ
                    | .
                    | The mean value theorem says that there exists #[m x_0 \in \lb \alpha , p/q )] s.t.
                    me \frac{f(p/q) - \cancelto{0}{f(\alpha)}}{p/q - \alpha} = f'(x_0)
                    | so
                    me \frac{q^nf(p/q) }{q^n f'(x_0)} = |p/q - \alpha|
                    | , notice how #[m n] appears here.

            p
                | This theme of using some calculus is repeated across diophantine analysis.

            remark
                p
                    ul
                        li
                            | Thue: can replace #[m n] with #[m (\deg(\alpha) + 2)/2]
                            | (This already has implications to integral solutions of degree #[m \ge 3] polynomials #[m f \in \ZZ\lb x \rb], e.g. elliptic curves with bounded integral discriminant)
                        li
                            | Roth (#[m \sim] 1958): for all #[m \epsilon \gt 0 ], there are only finitely many #[m p/q] satisfying
                            me | \alpha - \frac pq| \lt  \frac{1}{q^{2+\epsilon}}
                            | .

        paragraphs
            title Back to equidistribution

            p
                | #[m a_n =  \left\{n \alpha\right\} , \left\{a_n\right\}_{n=1}^\infty].

            theorem
                title Kronecker
                statement: p
                    | #[m a_n] is dense in #[m \lb 0,1)] if #[m \alpha \not \in \QQ].
                proof: p
                    | Will show for any #[m x \in \lb 0,1)] there exists
                    me \left\{ a_{n_j}\right\}_{j=1}^\infty\text{ s.t. } a_{n_j} \to x
                    | .
                    | Notation #[m \| x\|] means the distance to the nearest integer.

                    | Dirichlet implies that infinitely many #[m p/q] have #[m \alpha - p/q| \lt 1/q^2].
                    // TODO xref
                    | Given #[m \epsilon \gt 0] let  #[m q] be such that
                    me | \alpha - \frac pq |  \lt \frac{1}{q^2} \implies | q\alpha - p| \lt \frac 1q
                    me \frac 1q \lt \epsilon
                    | Choose #[m j] such that #[m j (\alpha q- p)] is within #[m 1/q] of #[m x] (why?).
                    | So
                    me \| j(\alpha q - p ) -x\| \lt \frac 1q \lt \epsilon
                    |. (Fill in the gaps here).

            p
                | Now let's define what is means to be uniformly distributed.

            definition#def-unif-dist
                title Uniformly distributed sequence
                statement: p
                    | #[m a_1, a_2, \ldots] is called #[term uniformly distributed] if for all #[m (b,c) \subseteq \lb 0,1)]
                    me \#\left\{ n \le N : \left\{ a_n\right\} \in (b,c) \right\} \sim N(c-b)
                    | or
                    me \lim_{N \to \infty} \frac{\#\left\{ n \le N : \left\{ a_n\right\} \in (b,c) \right\}}{N} = c-b
                    | .

            p
                | Uniformly distributed or not?
            p
                | When #[m \alpha \in \RR \smallsetminus \QQ]:  #[m \{ n\alpha \}], #[m \{ n^2\alpha \}], #[m \{ (3n^2 + 2n + 1)\alpha \}] #[m \{ (\sqrt 5 n^3  + 2n - (\zeta_{10} + \bar \zeta_{10}))\alpha \}] all are.
            p
                | #[m  \{ n! e \}],  #[m \{\log(n)\}] and #[m \{ \log (p_n)\}] are not.

        aside: p Lecture 3 13/9/2018

        example
            title Several
            p
                ol
                    li
                        | #[m \alpha\in \RR\smallsetminus\QQ,\,a_n = \{n\alpha\}]. Yes
                    li
                        | #[m \alpha\in \RR\smallsetminus\QQ,\,a_n = \{n^2\alpha + \}]. Yes
                    li
                        | #[m a_n = \{\log(n)\}]. No
                    li
                        | #[m a_n = \{n! e\}]. No (not dense).
                    li
                        | #[m \{ \log (p_n)\}]. No.
                    li
                        | #[m a_n = \{\sqrt{n}\}]. Yes.
                    li
                        | #[m a_n = \{e^n\}]. ?
                    li
                        | #[m a_n = \{\log n!\}]. Yes ?
                    li
                        | #[m a_n = \{\log \log n!\}]. No

            p
                | To begin let's show #[m a_n = \{n!e\}] is not equidistributed as it has only one limit point #[m 0].
                me e = \sum_{n=1}^\infty \frac{1}{n!}
                | so #[m n!e \in \ZZ + \frac{1}{n+1} + \frac{(n+1)(n+2)} + \cdots \le \frac{e}{n+1} \to 0], as #[m n\to \infty].
                | So its not dense, hence certainly not equidistributed.

        theorem
            statement: p
                | The sequence #[m a_n = \{ n\alpha\}] is equidistributed.
            proof
                p
                    | Let #[m \epsilon\gt 0], choose #[m M \gt 0] such that #[m \frac1M\lt \epsilon], furthermore choose a #[m \delta \lt \frac1M].
                    | Dirichlet implies there exists #[m m \in \ZZ] s.t. #[m \| m\alpha\| = \delta].
                    me  0\lt \delta \lt \frac1M \lt\epsilon
                    | recall #[m \| x\|] is the distance to the nearest integer.

                    | Consider the set #[m S_i = \left\{ \{n \alpha\} : n \lt N,\,n \equiv i \pmod m\right\}] then
                    me S = \{ \{n \alpha\} : n\lt N \}  = \bigsqcup_{i=1}^m S_i
                    | moreover,
                    me S_i =  \{\{ km\alpha + i\alpha\}  : 0 \le k \le N_i\}
                    | where
                    me N_i = \frac Nm + O(1)
                    | (why is the #[m O(1)] here?).
                    | We can rewrite these #[m S_i] as follows:
                    me S_i = \{ \delta k + \gamma_i \pmod 1 : 0 \le k \le N_i\}
                    | where
                    me.
                        \begin{cases} i\alpha \pmod 1 \amp \text{ if } \delta  = \{ m\alpha \} \\
                                      i\alpha - \delta (N_i + 1)\pmod 1 \amp \text{ if } \delta  = 1 - \{ m\alpha \} \\
                        \end{cases}

                    | replace #[m k] by #[m N_i  + 1-k ].
                p
                    | Now #[m 0 \le \gamma \lt 1] and let
                    me K_i = \lfloor \delta N_i + \gamma_i \rfloor
                    me \# \{ k \lt N_i : \{ \delta k + \gamma_i \} \in \lb b,c\rb \} = \sum_{j=0}^{K_i} \# \{k \le  N_i : \delta k + \gamma  \in [j+b,j+c] \}
                    me = (K_i + O(1)) \left(\frac{c-b}{\delta} + O(1) \right)
                    me N_i(c-b) + O\left( \frac {c-b}{\delta} + \delta N_i + 1 \right)
                    | so
                    me S =  \bigsqcup_{i=1}^m S_i
                    me \# S = N(c-b) + O\left( \frac M\delta + \delta N \right)
                    | (check!).
                    | Finally choose #[m N \gt \frac{M}{\delta^2}].
                    | So that
                    me \frac{M}{\delta} + \delta N \lt \epsilon N
                    | .
                    | Which implies
                    me \# \{ n \lt N : \{n\alpha \} \in [b,c] \}  =\#S =N(c-b) + \epsilon N
                    |.

        p
            | We followed our nose essentially, but we needed to put ourselves in a favourable position so that we can get a good handle on the error.

        example
            title 10

            statement: p
                | Consider the sequence
                me b_{m,i} = \frac i m
                | and define
                me a_{\binom{m}{2} + i } = b_{m,i}
                | so that
                me b_{m,i}
                me 0,1
                me 0,\frac 12 , 1
                me 0,\frac 13 ,\frac 23, 1
                me 0,\frac 14 ,\frac 24,\frac 34, 1
                me a_m = 0,1, 0,\frac 12 , 1, 0,\frac 13 ,\frac 23, 1, 0,\frac 14 ,\frac 24,\frac 34, 1
                | this is uniformly distributed!

        exercise
            statement: p
                | Prove this (in a similar way to before).

        proposition
            statement: p
                ol
                    li
                        | Any sequence has a rearrangement that is not uniformly distributed.
                    li
                        | Any dense sequence has a rearrangement that is uniformly distributed.
            proof: p
                ol
                    li
                        | If not sense we are done already.
                        | Otherwise let #[m I_1 = \lb 0, \frac 12) ,I_2 = \lb\frac 12, 1\rb]
                        | Let #[m X = \{a_n \in I_1\}, Y = \{a_n \in I_2\}], so both sets are infinite.
                        | Let #[m b_n  = x_1, \ldots, x_{10^{10}}, y_1, x_{10^{10} + 1}, \ldots, x_{20^{20}},\ldots]
                        | so #[m \# \{n:b_n  \in \lb4/5,1\rb \}  \sim \frac{N}{10^{10}}].
                    li
                        | If #[m a_n] is dense then, let
                        me b_{n,i} = a_m \text{ s.t. } \frac{i-1}{n} \lt a_m \lt \frac in
                        | by the example above this is equidistributed.

        p
            | What can we say about the space of uniformly distributed sequences?
            | Is it closed under addition? No (#[m a_n = -b_n]).
            | #[m \{k a_n\}] neither (#[m a_n = \alpha n,\,\frac1\alpha a_n = n]).
            | #[m a_nb_n] doesn't work either, but if #[m b_n] converges then #[m a_nb_n] is uniformly distributed.

    subsection
        title Weyl's criterion (1916)

        theorem
            title Weyl
            statement: p
                | #[m \{a_n\}_{n=1}^\infty \in \RR] then TFAE:
                ol
                    li
                        | #[m \{a_n\}_{n=1}^\infty] is uniformly distributed mod #[m 1].

                    li
                        | #[m \forall f \in C(\lb 0,1\rb)]
                        me \lim_{N\to \infty} \frac 1N \sum_{n=1}^N f(\{a_n\}) = \int _0^1 f \diff x
                        | .
                    li
                        me \lim_{N\to \infty} \frac 1N \sum_{n=1}^N e(ma_n) = \delta_m,\, \forall m \in \ZZ
                | where #[m e(x) = e^{2\pi i x}],
                me \delta_m = \begin{cases} 0 \amp m \ne 0 \\ 1 \amp m = 0 \end{cases}
                | .
            proof
                proofcase
                    title  #[m 1.\implies 2.]
                    aside: p Lecture 4 18/9/2018
                    p
                        | #[m 1.] means #[m 2.] is true for the characteristic function of #[m \lb b,c\rb], hence true for step functions (because everything is linear).
                    p
                        | Recall that any #[m f \in C\lb 0,1\rb)] is the uniform limit of such functions.
                    p
                        | Exercise: Choose one that is #[m \epsilon] close to #[m f] and finish the proof.

                proofcase
                    title  #[m 2.\implies 1.]
                    p
                        | Find #[m f_1,f_2 \in C(\lb 0,1 \rb)] such that #[m f_1(x) \le \chi_{(b,c)}(x) \le f_2(x)] s.t.
                        me \int f_1 - \chi_{(b,c)}) \le \epsilon
                        | Exercise, finish this proof.
                proofcase
                    title  #[m 2.\implies 3.]
                    p
                        | Obvious.
                proofcase
                    title  #[m 3.\implies 2.]
                    p
                        | Recall Fejér's theorem that #[m f\in C\lb 0,1 \rb)] is the uniform limit of its fourier series.
                        | Pick an #[m n \in \NN] s.t.
                        me f_n(x) - \epsilon \le f(x) \le f_n(x) + \epsilon
                        | .
                    p
                        | Exercise, finish this proof.


        p
            | Using this we can tackle more examples, e.g.:
            ol
                li #[m \{\alpha p_n\}], #[m n]-th primes, #[m \alpha\in \RR\smallsetminus \QQ].
                li #[m \{\sqrt{n}\}]
                li #[m \{\log(n)\}]
                li #[m \{\log(p_n)\}]
                li #[m \{\beta^n\}], #[m \beta \in \RR].
                li #[m \{\alpha a_n\}], #[m a_n \in \ZZ]

    subsection
        title Some applications of Weyl's criterion

        paragraphs
            title Application 1
            p
                | #[m \{n \alpha \}] is uniformly distributed iff #[m \alpha \in \RR\smallsetminus \QQ].
                | Let
                me S_N(h,\alpha) = \sum_{n=0}^N e(h\alpha n)
                |then
                me S_N(h,\alpha) = \frac{e((N+1) h\alpha) - 1}{e(h\alpha)  - 1}
                | .
                | Then #[m e(h\alpha ) - 1 \ne 0] for all #[m h \in \ZZ\smallsetminus \{0\} ] iff #[m \alpha \not \in \QQ] so #[m S_N(h,\alpha ) = O_{h,\alpha}(1) ] iff #[m \alpha \not \in \QQ].
                | So #[m \lim_{N \to \infty} S_N(h,\alpha)  = 0,\,\forall h \ne  0 \iff \alpha\not \in \QQ].
                | And #[m S_N(0,\alpha) = N+1] which implies
                me \lim_{N\to \infty} \frac1N S_N(0,\alpha) = 1
                | so by Weyl's criterion #[m \left\{ n\alpha \right\}] is uniformly distributed if #[m \alpha \not \in \QQ].

        paragraphs
            title Digression

            theorem
                title Vinogradov 1937
                statement: p
                    | #[m \{ \alpha p_n\} ] is uniformly distributed iff #[m \alpha \not \in \QQ].
            p
                | He actually showed weak Goldbach conjecture, Every (sufficiently large) #[em odd] integer is a sum of 3 primes.
                | No bound by Vinogradov, Borozdin gave a large bound, Helfgott brought it down to reality.

        paragraphs
            title Application 2
            p
                me \{\beta^n \}
            theorem
                title Koksma 1935
                statement: p
                    | For almost every (Lebesgue) #[m \beta\in \RR_{\gt 1}], #[m \left\{\beta^n\right\}] is equidistributed.
            p
                | Koksma was a Dutch student of Van der Corput.

            theorem
                title Weyl
                statement: p
                    | Let #[m |a_n| \to \infty] be a sequence of distinct integers, the set of #[m \alpha \in \RR] such that #[m \alpha a_n] is not uniformly distributed has Lebesgue measure 0.

        paragraphs
            title Application 3
            p
                me \{\log(n) \}
                | is not equidistributed.
            exercise
                statement: p
                    | Prove this.
                    | Hint : assume it was
                    me \# \{ n \lt 1001 N : \} =\# \{ n \lt 1000N : \} + \# \{1000N \le n \le 1001 N : \}
                    | then
                    me \log(n) - \log(100N + n_1) = \log(1000N) + \log (1+ n_1/1000N)

        paragraphs
            title Application 4
            p
                me \{\sqrt{n} \}
            p
                | Before this, lets introduce
            definition#def-discrepancy
                title Discrepancy
                statement: p
                    | Let #[m a_n \in \lb0,1)] be a sequence and #[m N\in \ZZ_{\ge 0}] we define
                    me D_N = \sup_{0\le b\le c \le 1}\left\{ \left| \frac{\# \{n \lt N : a_n \in [b,c ]\}}{N}  - (c-b)\right| \right\}
                    | .

            p
                | Some useful lemmas:
            lemma
                statement: p
                    | Let
                    me D_N^*= \sup_{0\le c \le 1}\left\{ \left| \frac{\# \{n \lt N : a_n \in [0,c ]\}}{N}  - c \right|\right\}
                    | then
                    me D_N^* \to 0 \iff D_N \to 0
                    | .
                proof
                    p
                        | Exercise (hint squeeze).

            lemma
                statement: p
                    | #[m a_n] is uniformly distributed #[m  \iff  D_N \to 0 \iff D_N^* \to 0].
                proof
                    p
                        | Ommitted/exercise, 2.1.1 of Kuipers and Niederreiter.

            p
                | For #[m \sqrt{n}] now.
                me S_N(c) = \# \{ n \le N : 0 \le \{ \sqrt n \} \le c\}
                | .
            note
                p
                    | If #[m d = \lfloor \sqrt{n} \rfloor] then
                    me \sqrt n =  d + \{ \sqrt n \}
                    | and #[m d \le \sqrt n \le d+ 1] and #[m \#\{ n :  d \le \sqrt  n \le d+ 1\} = 2d+ 2].
            p
                | Similarly
                me  \# \{ n : d \le \sqrt n \le d + \alpha \} = 2\alpha d + \alpha^2 + 1
                | then
                me S_N(\alpha) = \sum_{j=0}^{\lfloor \sqrt N \rfloor} \# \{ n : j + \alpha \le \sqrt n\le j + \alpha\}
                me             = \sum_{j=0}^{\lfloor \sqrt N \rfloor} 2\alpha d + \alpha^2 + O(1)
                me = 2\alpha  \frac{ \lfloor \sqrt N \rfloor (\lfloor \sqrt N \rfloor + 1)}{2} + O(\sqrt N) = \alpha N + O(\sqrt N)
                | so
                me D_N^* = \sum_{0\le \alpha \le  1} \left\{ \left| \frac{S_N(\alpha)}{N} -\alpha \right| \right\} = \sup_{0\le \alpha \le 1 } O_\alpha (1/\sqrt{N}) = O(1/\sqrt N)
                | .
            exercise
                statement: p
                    | Make the dependence on #[m \alpha ] explicit and make the proof rigorous.



        paragraphs
            title Application 5
            aside: p Lecture 5 20/9/2018
            proposition
                statement: p
                    me \{\log(p_n) \}
                    | is not equidistributed.
                proof
                    p
                        | Assume otherwise, let #[m k \in \ZZ_{\gt0}].
                        me I_k = \min\{ n : p_n \gt e^k \}
                        me I_{k-1/2} = \min\{ n : p_n \gt e^{k-1/2} \}
                        me \chi_{\lb 0,1/2)} = \text{char. fn. of }\lb 0, 1/2)
                        | .
                    p
                        | Consider
                        me S_k = \sum_{n \lt I_k} \chi_{\lb 0,1/2)} ( \{\log (p_n) \} )
                        me S_{k-1/2} = \sum_{n \lt I_{k-1/2}} \chi_{\lb 0,1/2\rb} ( \{\log (p_n) \} )
                    p
                        | Note that #[m S_k = S_{k-1/2}].
                    p
                        | If uniformly distributed
                        me \lim_{k\to \infty} \frac{S_k}{I_k} = \lim_{k\to \infty} \frac{S_{k-1/2}}{I_{k-1/2}} = L
                        me L\gt 0 \implies I_{k}/I_{k-1/2} \to 1
                        |.
                    p
                        | But the prime number theorem says
                        me \pi(N)  =\# \{ p \lt N \}  \sim \frac{N}{\log N}
                        | so
                        me I_{k}/I_{k-1/2} \sim \sqrt e \ne 1
                        | so #[m L=0] but this cannot happen either.
                        me S_{k-1/2} \ge \pi(e^{k-1/2}) - \pi (e^{k-1})
                        me           \ge e^{k-1} \frac{\sqrt e - 1}k \gt 0
                        | .

    subsection
        title Weyl differencing and the Van der Corput inequality


        theorem
            title Weyl
            statement: p
                | Let
                me P(x) = a_n x^n + a_{n-1} x^{n-1} + \cdots + a_0 \in \RR\lb x\rb
                | then
                me \{P(n)\}
                | is uniformly distributed mod 1 iff there exists #[m n_0 \in \lb n \rb] s.t. #[m a_{n_0} \not \in \QQ].

        lemma
            title Weyl differencing
            statement: p
                | Let #[m y_n  \in \CC], such that #[m y_n = 0] if #[m n \lt 1] or #[m n \gt N] then we would like to bound
                me \sum_m \sum_n y_n \overline y_m  = \sum_{m,n=1}^N = S_N \overline S_N = |S_N|^2
                | , Weyl differencing gives
                me \sum_{m=1}^N \sum_{n=1}^N y_n \overline y_m  = \underbrace{\sum_n |y_n| ^2}_{\text{diagonal contribution}}  + \underbrace{2 \Re \left( \sum_{n=1}^{N-1} \sum_{m=1}^{N-n} y_{n+m} \overline y_m \right) }_{\text{off diagonal terms}}
                | .
            proof
                p
                    | Idea: Use the transformation
                    me n \mapsto n+ m
                    me m \mapsto m
                    me.
                        \begin{pmatrix} n\\ m\end{pmatrix}
                        \begin{pmatrix} 1\amp 1 \\ 0 \amp 1\end{pmatrix}
                    | switch orders
                figure
                    caption Regions
                    image: latex-image.
                        <![CDATA[
                        \begin{tikzpicture}
                            \draw[thick] (-1,0) -- (5,0);
                            \draw[thick] (0,-1) -- (0,5);
                            \filldraw[fill=gray!20!white, draw=gray!20!black] (1,1) -- (1,4) -- (4,4) -- (4,1) -- (1,1);
                            \draw[thick] (7,0) -- (12,0);
                            \draw[thick] (8,-1) -- (8,5);
                            \filldraw[fill=gray!20!white, draw=gray!20!black] (8,1) -- (5,4) -- (8,4) -- (11,1) -- (8,1);
                        \end{tikzpicture}
                        ]]>
                p
                    me \sum_m \sum_n y_n \overline y_m =  \sum_m \sum_n y_{n+m} \overline y_m
                    | Note: if #[m n \ge 0] then #[m m  = 1 ,\ldots, N-n],  #[m n = 0, 1,\ldots, N-1].
                    | If #[m n \lt 0] then
                    me m = 1-n, \ldots, N
                    me n = 1-N, \ldots, -1
                    me \sum_{m=1}^N |y_m|^2 + \sum_{n=1}^{N-1} \sum_{m=1}^{N-n} y_{n+m}\overline y_m +  \sum_{n = -N+1}^{-1} \sum_{m= 1-n}^N y_{m+n} \overline y_m
                    me = \sum_{m=1}^N |y_m| ^2  + 2 \Re \left( \sum_{n=1}^{N-1} \sum _{m=1}^{N-n} y_{n+m} \overline y_m \right)


        theorem
            title Weyl
            statement: p
                | Let #[m |x_n| \to \infty] be a sequence of distinct integers, the set of #[m \alpha \in \RR] such that #[m \alpha x_n] is not uniformly distributed has Lebesgue measure 0.
            proof
                p
                    | Let #[m \alpha \in  \lb 0,1)], let #[m h \in \ZZ \smallsetminus \{ 0 \}]
                    me S_h(N,\alpha) = \frac 1N \sum_{n=1}^N e(hx_n\alpha)
                    | the trick is now to bound #[m |S_h(N,\alpha)|^2]
                    me N^2|S_h(N,\alpha)|^2 = \sum_{n=1}^N 1 +2\Re \left( \sum_{n=1}^{N-1} \sum_{m=1}^{N-n} e(h(x_{n+m} - x_m) \alpha) \right)
                    | so
                    me \int_0^1 |S_h(N,\alpha)|^2 \diff \alpha = \frac 1N
                    | .
                p
                    | Recall Fatou's lemma:
                    | Let #[m f_n  \gt 0] be  sequence of positive measurable functions, then if
                    me f(x) = \liminf f_n(x)
                    | we have
                    me \int f \le \liminf \int f_n
                    | .
                p
                    | Take
                    me f_n(\alpha) = \sum_{N=1}^{n} | S_h (N^2,\alpha)|^2
                    | Fatou implies
                    me  \int_0^1 \sum_{n=1}^\infty |S_h(N^2,\alpha)|^2 \diff \alpha \le \sum_{N=1}^\infty \int_0^1 |S_h(N^2,\alpha)|^2\diff \alpha \lt \infty
                    | so
                    me \sum_{N=1}^\infty  |S_h(N^2 ,\alpha)|^2
                    | is finite for almost all #[m \alpha] and for any #[m h \ne 0].
                    | Then by Weyl's criterion we are done.

        theorem
            title Van der Corput
            statement: p
                | Let #[m y_n  \in \CC], such that #[m y_n = 0] if #[m n \lt 1] or #[m n \gt N] then
                me \forall h \in \ZZ_{\gt 0 }
                | we have
                me \left| \sum_{n=1}^N y_n \right|^2 \le \frac{N+ H} {H+1 } \sum_{n=1}^N |y_n|^2 + \frac{2(N+H)}{H+!} \sum_{n=1}^H \left(1 - \frac h{H+1} \right) \left| \sum_{n=1}^{N-h} y_{n+h} \overline y_n\right|
                | .
